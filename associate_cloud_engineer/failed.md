# Udemy 講座で間違った問題

## Deployment Manager の preview フラグ

あなたが参加しているプロジェクトでは、Deployment Manager を使用してリソースをデプロイします。あなたはテンプレートに大きな変更を加えました。変更をコミットする前に、定義されている全てのリソースの依存関係が適切に満たされていることを確認する必要があります。変更後の結果を最も素早く確認するには、どうすれば良いでしょうか？

> [!TIP]
> gcloud コマンドラインツールを--preview フラグを使用して実行する。実行結果で相互に依存するリソースの状態を確認する。

> [!WARNING]
> --dry-run は存在しない

## VM インスタンスの停止コマンド

あなたの所属する企業では複数の VM インスタンスを使用して Web アプリケーションを実行しています。あなたは gcloud コマンドツールを使用して web-app-1 という名前のインスタンスを停止する必要があります。以下のうち、どのコマンドを実行すれば良いでしょうか？

> [!TIP]
> gcloud compute instances stop web-app-1

> [!WARNING]
> gcloud compute stop web-app-1 は無効なコマンド。

## App Engine の環境ごとの作成方法

あなたのチームは App Engine アプリケーションを開発しており、開発環境でのテストを完了しました。新しいプロジェクトを本番環境として作成し、アプリケーションを実行する必要があります。どうすれば良いでしょうか？下記の手順から適切なものを２つ選択して下さい。

> [!TIP]
>
> 1. gcloud projects create コマンドを使用して新しいプロジェクトを作成する。
> 2. --project フラグに新しいプロジェクトの ID を指定し、gcloud app deploy コマンドを実行してアプリケーションを新しいプロジェクトにデプロイする。

> [!WARNING]
> gcloud app copy は無効なコマンド。

## Cloud Spanner における自動スケーリング設定

あなたは Cloud Spanner をデータベースとして使用するアプリケーションを管理しています。アプリケーションのトラフィックに基づいて Spanner ノードをスケーリングする必要があります。迅速かつ自動的にスケーリングを実行するのに適切な手順を下記から選択して下さい。

> [!TIP]
> Cloud Spanner インスタンスの CPU 使用率がしきい値の範囲外となった時にトリガーされる Cloud Monitoring アラートポリシーを作成し、通知チャネルを Cloud Pub/Sub に設定する。Pub/Sub トピックをサブスクライブし、リソースをスケーリングする Cloud Functions を作成する。

> [!NOTE]
> Cloud Monitoring で Cloud Spanner インスタンスの CPU 使用率メトリクスを設定し、しきい値に基づいたアラートを作成することにより、Webhook にアラートを送信することが出来ます。また、その HTTP Webhook をリッスンする Cloud Functions 関数内でスケーリングを行うことにより、自動的に Spanner ノードをスケーリングできます。

> [!WARNING]
> Cloud Spanner インスタンスの CPU 使用率がしきい値の範囲外となった時にトリガーされる Cloud Monitoring アラートポリシーを作成し、通知チャネルをサポートエンジニアの SMS に設定する。サポートは SMS に応じてリソースをスケーリングする。

## Deployment Manager のデプロイメント更新コマンド

あなたは new-config.yaml というファイルを使用し、Deployment Manager の以前のデプロイメントを更新する必要があります。以下のうち、どのコマンドを実行すれば良いでしょうか？

> [!TIP]
> gcloud deployment-manager deployments update --config new-config.yaml
> 構成ファイルに基づいてデプロイメントを更新できる

> [!WARNING]
> gcloud deployment-manager resources update --config new-config.yaml は無効なコマンド

## 別のサブネットのインスタンス間通信実現

あなたは Google クラウド上で開発用と本番用の VM インスタンス群をセットアップしています。本番用インスタンスは開発用とは別のサブネットに配置する必要があります。インスタンス同士が VPC の内部 IP を介して相互に通信できるようにするには、どうすれば良いでしょうか？最小限の労力で実現する方法を、以下から選択して下さい。

> [!TIP]
> サブネット作成モードがカスタムの VPC を一つ作成し、異なる CIDR ブロックを持つ二つのサブネットを作成する。

> [!WARNING]
> 開発用と本番用の二つのプロジェクトを作成する。本番用プロジェクトをホストプロジェクトとして共有 VPC を設定する。プロジェクトを作成する必要はない

## 新しいメンバーに Cloud Spanner インスタンスへの権限を与える

あなたの管理するチームに新しく数人のクラウドエンジニアが加入します。新しいチームメンバーに Cloud Spanner インスタンスのテーブル情報を表示および編集できるアクセスを提供する必要があります。運用上の効率を優先しつつ必要なアクセス権限を付与する方法を、以下から選択して下さい。

> [!TIP]
> 新しく Google グループを作成する。チームメンバーの各ユーザーをグループに関連付け、グループに roles/spanner.databaseUser ロールを付与する。

> [!WARNING]
> roles/spanner.viewer ロールを付与すると、Cloud Spanner でデータを表示するためのアクセス許可を与えることができますが、テーブルを編集する権限がありません。

## VPC 間の VPN 接続構成

10.22.0.1/22 のネットワークアドレス空間を持つ新しい VPC と既存の VPC の間に、可用性の高い Virutal Private Network (VPN) 接続を構成する必要があります。VPN はダイナミックルーティングをサポートし、フェイルオーバー時のトンネルのオーバープロビジョニングを回避する必要があります。どうすれば良いでしょうか。

> [!TIP]
> カスタムモードの VPC ネットワークと Cloud Router を使用して、VPN トンネルのペアを構成する。

> [!NOTE]
> カスタムモードの VPC ネットワークと Cloud Router を使用して VPN トンネルのペアを構成することにより、1 つのトンネルに障害が発生した場合でも冗長性が確保され、高可用性が保証されます。また、 カスタムモード VPC では、BGP のようなダイナミックルーティングプロトコルを設定でき、手動による介入なしに VPC 間の自動ルート交換が可能です。さらに、Cloud Router は、トラフィック需要に基づいてトンネルの容量を自動的に調整し、フェイルオーバー時に不要なトンネルが作成されるのを防ぎます。

> [!WARNING]
> カスタムモード VPC ネットワークと Cloud Router を使用して単一の VPN トンネルを構成する。

## GKE のクラスタ認証

あなたは test-cluster と prod-cluster という 2 つの Google Cloud Kubernetes (GKE)クラスターを管理しています。test-cluster は Standard クラスター、prod-cluster は Autopilot クラスターです。

kubectl get nodes コマンドを実行すると、test-cluster のノードのみが表示されます。kubectl get Nodes コマンドを介して prod-cluster のノードのステータスを確認するには、どのコマンドを実行する必要がありますか?

> [!TIP]
> gcloud container clusters get-credentials prod-cluster
>
> prod-cluster の認証情報を取得し、kubectl でアクセスできるようにするコマンド。これを実行すると、kubectl get nodes で prod-cluster のノード情報を取得できるようになりま

> [!NOTE]
> gcloud container clusters get-credentials コマンドは、適切な認証情報とエンドポイント情報を使用して kubeconfig ファイルを更新し、kubectl が Google Kubernetes Engine の特定のクラスターを指すようにします。

> [!WARNING]
> kubectl config use-context コマンドは、現在のコンテキストを切り替えるコマンドです。クラスターへのアクセスに必要な認証情報の取得や構成は行いません。

## 複雑な管理の必要がない高パフォーマンスのデータベース

あなたはマルチプレイヤーゲームを開発しています。ゲームは世界中のユーザーにプレイされ、 ユーザー数は増加していく事が予測されます。また、ピーク時においても低レイテンシでパフォーマンスの低下がないことが求められます。データベースサービスは、最小限の管理コストで上記の要件を満たす必要があります。ゲームデータを保存するのに最適なデータベースを以下から選択して下さい。

> [!TIP]
> Cloud Spanner

> [!NOTE]
> Cloud Spanner は、複雑な管理を必要とせず、グローバルなマルチプレイヤーゲームアプリケーションに必要な強力な整合性とスケーラビリティを提供します。また、水平スケーリングをサポートし、ユーザー数の増加やピーク時にも高いパフォーマンスを提供します。このシナリオでは Cloud Spanner が最適な選択肢となります。

> [!WARNING]
> クロスリージョンレプリケーションを有効化した Cloud SQL
>
> Cloud SQL のクロスリージョンレプリケーションは可用性を向上させますが、Cloud Spanner と比較した場合、グローバルな整合性を保つために遅延が発生する可能性があります。また、データベースのチューニングとレプリケーション設定により大きな管理オーバーヘッドが発生します。

## Cloud Storage へのアクセスを許可するロール

新しく作成した Compute Engine インスタンスにサードパーティアプリケーションをデプロイします。アプリケーションのインストール用ファイルは Cloud Storage バケットに保存されています。 Google が推奨する方法に従って、インスタンスにファイルへのアクセスを許可するにはどうすればよいですか?

> [!TIP]
> 新しいサービスアカウントをインスタンスに割り当て、バケットに対する Storage Object Viewer IAM ロールを付与する。

> [!NOTE]
> Google の推奨する最小権限の原則に沿って、新しいサービスアカウントを Compute Engine インスタンスに割り当て、そのサービスアカウントにバケットに対する Storage Object Viewer IAM ロールを付与します。これにより、インスタンスはバケット内のオブジェクトを読み取ることができます。

> [!WARNING]
> 新しいサービスアカウントをインスタンスに割り当て、バケットに対する Storage Admin IAM ロールを付与する。
>
> 新しいサービスアカウントに Storage Admin IAM ロールを付与すると、そのサービスアカウントはバケット内のオブジェクトを表示、作成、更新、削除することができます。しかし、本シナリオでは、インスタンスが必要とするのはオブジェクトの読み取り権限のみであり、Storage Admin IAM ロールは必要以上の権限を付与することになります。

## Dataflow のユースケース

あなたの会社は、毎日の販売データを分析し、日次レポートを生成したいと考えています。販売データの規模は大きく、処理には数時間かかります。効率的かつ運用コストを抑えたプロセスでレポートを生成するには、どうすれば良いでしょうか？

> [!TIP]
> Dataflow で販売データをバッチ処理し、結果を BigQuery に保存する。

> [!NOTE]
> Dataflow は、分散処理を使用して大規模なデータセットを処理するためのサービスであり、バッチ処理にも適しています。販売データの処理には数時間かかるため、Dataflow を使用してデータをバッチ処理し、その結果を BigQuery に保存することで、処理の効率性を確保できます。また、BigQuery は大量のデータを効率的にクエリできるため、データ分析用の日次レポートを生成するのに適しています。

> [!WARNING]
> Compute Engine で販売データをバッチ処理し、結果を BigQuery に保存する。
> Compute Engine で大量のデータを処理するためには、設定や管理が必要となり、Dataflow よりも効率性や運用コストの面で劣ります。

## Cloud Engine と Cloud Storage へのアクセス管理

あなたは Google Cloud エンジニアとしてある企業に勤務しています。開発チームは社内の様々な Google Cloud プロジェクトで Compute Engine と Cloud Storage へアクセスする必要があります。一貫した権限を保証するセキュリティポリシーを実装するための、最も効率的で安全な手順は以下のうちどれでしょうか？(二つ選択してください)

> [!TIP]
>
> 1. Cloud Identity の Google グループにすべての開発者を追加する。
> 2. Google Cloud 組織レベルで Compute Engine と Cloud Storage の権限を持つカスタムロールを作成し、Google グループに割り当てる。

> [!NOTE]
> Cloud Identity の Google グループに開発者を追加することで、ユーザアクセスと権限を一元管理できます。一方、組織レベルで必要な権限を持つカスタムロールを作成することで、さまざまなプロジェクトで指定されたサービスへの一貫した制限付きアクセスが保証されます。

## Cloud Scheduler の利用ケース

> [!TIP]
> Web アプリケーションを App Engine に移行し、API を Cloud Run に移行する。Cloud Scheduler を使用して、Cloud Run でデータ処理ジョブを実行する。

> [!NOTE]
> Node.js で実装された Web アプリケーションは App Engine に、Go で実装されたバックエンド API は Cloud Run に移行します。そして、Python で書かれたデータ処理ジョブは Cloud Scheduler を使用して Cloud Run で定期的に実行します。これにより、開発者のみで構成されるチームでも、運用コストを最小限に抑えつつ、効率的にワークロードを Google Cloud に移行することが可能となります。

> [!WARNING]
> Web アプリケーションを App Engine に移行し、API を Compute Engine に移行する。 Cloud Scheduler を使用して、Compute Engine でデータ処理ジョブを実行する。
>
> Compute Engine はサーバーレスソリューションと比べて運用コストが高くなり、本シナリオでは推奨されません。

## Resouter Manager が提供する IAM ポリシー管理

あなたの会社では、Google Cloud で Web アプリケーションを実行しています。アプリケーションで使用されるリソースは、異なるプロジェクトにデプロイされています。Resource Manager が提供する機能を使って、リソースの IAM ポリシーを効率的に管理したいと考えています。どうすれば良いでしょうか？

> [!TIP]
> アプリケーション用のフォルダを作成し、そのフォルダに IAM ポリシーを割り当てる。次に、アプリケーションのリソースをそのフォルダに追加する。

> [!NOTE]
> Google Cloud のフォルダでは、同じアプリケーションに属するリソースをグループ化することができます。フォルダに IAM ポリシーを割り当てることで、フォルダ内のすべてのリソースのアクセス制御を一度に管理できます。

> [!WARNING]
> アプリケーションの請求先アカウントを作成し、IAM ポリシーをそのアカウントに割り当てる。次に、アプリケーションのリソースを請求先アカウントに関連付ける。
>
> 請求先アカウントは、Google Cloud の使用料を追跡し、請求するためのものであり、IAM ポリシーの管理およびリソースのアクセス制御とは直接関係ありません。

# 本で間違った問題
