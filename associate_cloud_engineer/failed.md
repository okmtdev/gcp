# Udemy 講座で間違った問題

## Deployment Manager の preview フラグ

あなたが参加しているプロジェクトでは、Deployment Manager を使用してリソースをデプロイします。あなたはテンプレートに大きな変更を加えました。変更をコミットする前に、定義されている全てのリソースの依存関係が適切に満たされていることを確認する必要があります。変更後の結果を最も素早く確認するには、どうすれば良いでしょうか？

> [!TIP]
> gcloud コマンドラインツールを--preview フラグを使用して実行する。実行結果で相互に依存するリソースの状態を確認する。

> [!WARNING]
> --dry-run は存在しない

## VM インスタンスの停止コマンド

あなたの所属する企業では複数の VM インスタンスを使用して Web アプリケーションを実行しています。あなたは gcloud コマンドツールを使用して web-app-1 という名前のインスタンスを停止する必要があります。以下のうち、どのコマンドを実行すれば良いでしょうか？

> [!TIP]
> gcloud compute instances stop web-app-1

> [!WARNING]
> gcloud compute stop web-app-1 は無効なコマンド。

## App Engine の環境ごとの作成方法

あなたのチームは App Engine アプリケーションを開発しており、開発環境でのテストを完了しました。新しいプロジェクトを本番環境として作成し、アプリケーションを実行する必要があります。どうすれば良いでしょうか？下記の手順から適切なものを２つ選択して下さい。

> [!TIP]
>
> 1. gcloud projects create コマンドを使用して新しいプロジェクトを作成する。
> 2. --project フラグに新しいプロジェクトの ID を指定し、gcloud app deploy コマンドを実行してアプリケーションを新しいプロジェクトにデプロイする。

> [!WARNING]
> gcloud app copy は無効なコマンド。

## Cloud Spanner における自動スケーリング設定

あなたは Cloud Spanner をデータベースとして使用するアプリケーションを管理しています。アプリケーションのトラフィックに基づいて Spanner ノードをスケーリングする必要があります。迅速かつ自動的にスケーリングを実行するのに適切な手順を下記から選択して下さい。

> [!TIP]
> Cloud Spanner インスタンスの CPU 使用率がしきい値の範囲外となった時にトリガーされる Cloud Monitoring アラートポリシーを作成し、通知チャネルを Cloud Pub/Sub に設定する。Pub/Sub トピックをサブスクライブし、リソースをスケーリングする Cloud Functions を作成する。

> [!NOTE]
> Cloud Monitoring で Cloud Spanner インスタンスの CPU 使用率メトリクスを設定し、しきい値に基づいたアラートを作成することにより、Webhook にアラートを送信することが出来ます。また、その HTTP Webhook をリッスンする Cloud Functions 関数内でスケーリングを行うことにより、自動的に Spanner ノードをスケーリングできます。

> [!WARNING]
> Cloud Spanner インスタンスの CPU 使用率がしきい値の範囲外となった時にトリガーされる Cloud Monitoring アラートポリシーを作成し、通知チャネルをサポートエンジニアの SMS に設定する。サポートは SMS に応じてリソースをスケーリングする。

## Deployment Manager のデプロイメント更新コマンド

あなたは new-config.yaml というファイルを使用し、Deployment Manager の以前のデプロイメントを更新する必要があります。以下のうち、どのコマンドを実行すれば良いでしょうか？

> [!TIP]
> gcloud deployment-manager deployments update --config new-config.yaml
> 構成ファイルに基づいてデプロイメントを更新できる

> [!WARNING]
> gcloud deployment-manager resources update --config new-config.yaml は無効なコマンド

## 別のサブネットのインスタンス間通信実現

あなたは Google クラウド上で開発用と本番用の VM インスタンス群をセットアップしています。本番用インスタンスは開発用とは別のサブネットに配置する必要があります。インスタンス同士が VPC の内部 IP を介して相互に通信できるようにするには、どうすれば良いでしょうか？最小限の労力で実現する方法を、以下から選択して下さい。

> [!TIP]
> サブネット作成モードがカスタムの VPC を一つ作成し、異なる CIDR ブロックを持つ二つのサブネットを作成する。

> [!WARNING]
> 開発用と本番用の二つのプロジェクトを作成する。本番用プロジェクトをホストプロジェクトとして共有 VPC を設定する。プロジェクトを作成する必要はない

## 新しいメンバーに Cloud Spanner インスタンスへの権限を与える

あなたの管理するチームに新しく数人のクラウドエンジニアが加入します。新しいチームメンバーに Cloud Spanner インスタンスのテーブル情報を表示および編集できるアクセスを提供する必要があります。運用上の効率を優先しつつ必要なアクセス権限を付与する方法を、以下から選択して下さい。

> [!TIP]
> 新しく Google グループを作成する。チームメンバーの各ユーザーをグループに関連付け、グループに roles/spanner.databaseUser ロールを付与する。

> [!WARNING]
> roles/spanner.viewer ロールを付与すると、Cloud Spanner でデータを表示するためのアクセス許可を与えることができますが、テーブルを編集する権限がありません。

## VPC 間の VPN 接続構成

10.22.0.1/22 のネットワークアドレス空間を持つ新しい VPC と既存の VPC の間に、可用性の高い Virutal Private Network (VPN) 接続を構成する必要があります。VPN はダイナミックルーティングをサポートし、フェイルオーバー時のトンネルのオーバープロビジョニングを回避する必要があります。どうすれば良いでしょうか。

> [!TIP]
> カスタムモードの VPC ネットワークと Cloud Router を使用して、VPN トンネルのペアを構成する。

> [!NOTE]
> カスタムモードの VPC ネットワークと Cloud Router を使用して VPN トンネルのペアを構成することにより、1 つのトンネルに障害が発生した場合でも冗長性が確保され、高可用性が保証されます。また、 カスタムモード VPC では、BGP のようなダイナミックルーティングプロトコルを設定でき、手動による介入なしに VPC 間の自動ルート交換が可能です。さらに、Cloud Router は、トラフィック需要に基づいてトンネルの容量を自動的に調整し、フェイルオーバー時に不要なトンネルが作成されるのを防ぎます。

> [!WARNING]
> カスタムモード VPC ネットワークと Cloud Router を使用して単一の VPN トンネルを構成する。

# 本で間違った問題
